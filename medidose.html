<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediDose Label Generator</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
</head>
<body>
    <!-- Password Modal to Access Page -->
    <div id="password-modal" style="display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; justify-content: center; align-items: center;">
        <div style="background: white; padding: 40px; border-radius: 10px; max-width: 400px; width: 90%;">
            <h2 style="margin-top: 0;">Enter Password</h2>
            <form id="password-check-form">
                <div class="form-group">
                    <input type="password" id="password-input" placeholder="Password" required style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 1em; box-sizing: border-box;">
                </div>
                <button type="submit" style="width: 100%; padding: 12px; background: #007bff; color: white; border: none; border-radius: 5px; font-size: 1em; cursor: pointer;">Submit</button>
                <div id="password-error" style="color: #dc3545; margin-top: 10px; display: none;">Incorrect password!</div>
            </form>
        </div>
    </div>

    <nav class="sidebar">
        <div class="sidebar-header">
            <h2>Menu</h2>
        </div>
        <ul class="sidebar-nav">
            <li><a href="index.html">Home</a></li>
            <li><a href="medidose.html" class="active">MediDose Labels</a></li>
            <li><a href="rxlabel.html">Rx Labels</a></li>
            <li><a href="settings.html">Settings</a></li>
        </ul>
    </nav>

    <div class="main-content" id="main-content" style="display: none;">
        <div class="container">
            <h1>Medication Label Generator</h1>
            <form id="labelForm">
                <div class="form-group">
                    <label for="brandName">Brand Name</label>
                    <input type="text" id="brandName" placeholder="brand name" required>
                </div>

                <div class="form-group">
                    <label for="genericName">Generic Name</label>
                    <input type="text" id="genericName" placeholder="generic name" required>
                </div>

                <div class="form-group">
                    <label for="ndc">NDC</label>
                    <input type="text" id="ndc" placeholder="XXXX-XXXX-XX" required>
                </div>

                <div class="form-group">
                    <label for="strength">Strength</label>
                    <input type="text" id="strength" placeholder="strength (include units)" required>
                </div>

                <div class="form-group">
                    <label for="form">Form</label>
                    <input type="text" id="form" placeholder="(tablets, capsules, etc.)" required>
                </div>

                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" placeholder="packager" required>
                </div>

                <div class="form-group">
                    <label for="controlled">Controlled</label>
                    <select id="controlled">
                        <option value="">None</option>
                        <option value="2">Schedule II</option>
                        <option value="3">Schedule III</option>
                        <option value="4">Schedule IV</option>
                        <option value="5">Schedule V</option>
                    </select>
                </div>

                <button type="submit" class="generate-btn">create medidose label</button>
            </form>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="firebase-data.js"></script>

    <script>
    // Password protection to access the page
    const passwordModal = document.getElementById('password-modal');
    const passwordCheckForm = document.getElementById('password-check-form');
    const passwordInput = document.getElementById('password-input');
    const passwordError = document.getElementById('password-error');
    const mainContent = document.getElementById('main-content');

    passwordCheckForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const password = passwordInput.value;
        
        try {
            const isValid = await settingsManager.verifyPassword(password);
            if (isValid) {
                passwordModal.style.display = 'none';
                mainContent.style.display = 'block';
                passwordError.style.display = 'none';
            } else {
                passwordError.style.display = 'block';
                passwordInput.value = '';
            }
        } catch (error) {
            console.error('Error checking password:', error);
            passwordError.textContent = 'Error checking password. Please try again.';
            passwordError.style.display = 'block';
        }
    });
    </script>

    <script src="medidose-script.js"></script>
    <script src="footer.js"></script>
</body>
</html>